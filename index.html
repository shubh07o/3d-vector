<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mathematics Mock Test: Vectors & 3D Geometry</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Apply Inter font to the whole page */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom scrollbar for aesthetics */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9; /* gray-100 */
        }
        ::-webkit-scrollbar-thumb {
            background: #94a3b8; /* gray-400 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* gray-500 */
        }
        /* Style for the custom radio button label when checked */
        input[type="radio"]:checked + label {
            background-color: #e0f2fe; /* sky-100 */
            border-color: #0ea5e9; /* sky-500 */
            font-weight: 600;
            color: #0369a1; /* sky-700 */
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div id="app" class="bg-white p-6 md:p-8 rounded-2xl shadow-xl w-full max-w-3xl mx-auto">

        <div id="start-screen" class="text-center">
            <h1 class="text-3xl font-bold text-gray-800 mb-4">Mathematics Mock Test</h1>
            <p class="text-lg text-gray-600 mb-6">Chapters: Vector Algebra & 3D Geometry</p>
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 text-left">
                <h2 class="text-xl font-semibold text-blue-800 mb-2">Test Instructions</h2>
                <ul class="list-disc list-inside text-gray-700 space-y-1">
                    <li>Total Questions: <strong>50</strong></li>
                    <li>Time Limit: <strong>60 Minutes</strong></li>
                    <li>Correct Answer: <strong>+1 Mark</strong></li>
                    <li>Incorrect Answer: <strong>-0.25 Marks</strong></li>
                    <li>Unanswered: <strong>0 Marks</strong></li>
                    <li>Click "Submit Test" when you are finished.</li>
                </ul>
            </div>
            <button id="start-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all duration-300 text-lg shadow-md">
                Start Test
            </button>
        </div>

        <div id="test-screen" class="hidden">
            <div class="flex justify-between items-center mb-6 sticky top-0 bg-white pt-2 pb-4 border-b">
                <h1 class="text-2xl font-bold text-gray-800">Mathematics Test</h1>
                <div id="timer" class="font-mono text-2xl font-bold bg-gray-100 text-gray-800 py-2 px-4 rounded-lg shadow-inner">
                    60:00
                </div>
            </div>

            <div id="questions-container" class="space-y-8 max-h-[75vh] overflow-y-auto pr-2">
                </div>
        </div>

        <div id="results-screen" class="hidden">
            <h1 class="text-3xl font-bold text-gray-800 mb-4 text-center">Test Results</h1>
            
            <div id="score-summary" class="bg-gray-50 rounded-lg p-6 mb-6 text-center shadow-md">
                </div>

            <h2 class="text-2xl font-semibold text-gray-700 mb-4">Detailed Breakdown</h2>
            <div id="results-details" class="space-y-4 max-h-[50vh] overflow-y-auto pr-2">
                </div>
            
            <div class="mt-8">
                <button id="restart-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all duration-300 text-lg shadow-md">
                    Take Test Again
                </button>
            </div>
        </div>

    </div>

    <script>
        // --- 1. DATA: All 50 Questions ---
        const questions = [
            // 1. Vector Basics & Algebra
            {
                q: "1. Find the magnitude of the vector a = 2i - 7j - 3k.",
                options: [
                    "(a) √62",
                    "(b) √58",
                    "(c) √6",
                    "(d) √54"
                ],
                answer: 0
            },
            {
                q: "2. Find the unit vector in the direction of the vector a = i + j + 2k.",
                options: [
                    "(a) (1/√6)(i + j + 2k)",
                    "(b) (1/√4)(i + j + 2k)",
                    "(c) i + j + 2k",
                    "(d) (1/6)(i + j + 2k)"
                ],
                answer: 0
            },
            {
                q: "3. If the vectors 2i + 3j - 6k and 4i - mj + 12k are collinear, what is the value of m?",
                options: [
                    "(a) 6",
                    "(b) -6",
                    "(c) 3",
                    "(d) -3"
                ],
                answer: 1
            },
            {
                q: "4. Find the vector PQ joining the points P(2, 3, 0) and Q(-1, -2, -4).",
                options: [
                    "(a) -3i - 5j - 4k",
                    "(b) 3i + 5j + 4k",
                    "(c) i + j - 4k",
                    "(d) -i - j + 4k"
                ],
                answer: 0
            },
            {
                q: "5. Find the coordinates of the point which divides the line segment joining A(1, -2, 3) and B(3, 4, -5) internally in the ratio 2:3.",
                options: [
                    "(a) (9/5, 2/5, -1/5)",
                    "(b) (9/5, 2, -1)",
                    "(c) (9, 2, -1)",
                    "(d) (2, 12/5, 1)"
                ],
                answer: 0
            },
            // 2. Dot Product & Projections
            {
                q: "6. Find a · b if a = i - 2j + k and b = 3i - 4j - 2k.",
                options: [
                    "(a) 13",
                    "(b) 9",
                    "(c) 3",
                    "(d) 5"
                ],
                answer: 1
            },
            {
                q: "7. Find the angle between the vectors a = i + j - k and b = i - j + k.",
                options: [
                    "(a) cos⁻¹(1/3)",
                    "(b) cos⁻¹(-1/3)",
                    "(c) 90°",
                    "(d) 60°"
                ],
                answer: 1
            },
            {
                q: "8. For what value of λ are the vectors a = 2i + 3j - k and b = λi - 4j + 8k perpendicular?",
                options: [
                    "(a) 10",
                    "(b) 4",
                    "(c) -4",
                    "(d) 20"
                ],
                answer: 0
            },
            {
                q: "9. Find the projection of the vector a = 2i - j + 2k on the vector b = i - 2j - 2k.",
                options: [
                    "(a) 0",
                    "(b) 1",
                    "(c) 2/3",
                    "(d) 8/3"
                ],
                answer: 0
            },
            {
                q: "10. If |a| = 3, |b| = 4, and a · b = 6√3, what is the angle between a and b?",
                options: [
                    "(a) 30°",
                    "(b) 60°",
                    "(c) 90°",
                    "(d) 45°"
                ],
                answer: 0
            },
            {
                q: "11. If a and b are unit vectors, what is the angle between them so that a - b is also a unit vector?",
                options: [
                    "(a) 30°",
                    "(b) 60°",
                    "(c) 90°",
                    "(d) 120°"
                ],
                answer: 1
            },
            {
                q: "12. Find the work done by the force F = i + 2j + 3k when it displaces a particle from A(1, 1, 1) to B(3, 3, 3).",
                options: [
                    "(a) 6",
                    "(b) 12",
                    "(c) 18",
                    "(d) 10"
                ],
                answer: 1
            },
            // 3. Cross Product & Area
            {
                q: "13. Find a x b if a = 2i + j - k and b = i - j + k.",
                options: [
                    "(a) 0i - 3j - 3k",
                    "(b) 0i + 3j + 3k",
                    "(c) 2i - j - k",
                    "(d) 2i - 3j - 3k"
                ],
                answer: 0
            },
            {
                q: "14. Find the area of the parallelogram whose adjacent sides are given by a = i + j - k and b = i - j + k.",
                options: [
                    "(a) 2√2",
                    "(b) √8",
                    "(c) 4√2",
                    "(d) 8"
                ],
                answer: 0
            },
            {
                q: "15. Find the area of the triangle with vertices A(1, 1, 2), B(2, 3, 5), and C(1, 5, 5).",
                options: [
                    "(a) √61",
                    "(b) (1/2)√61",
                    "(c) √14",
                    "(d) 7"
                ],
                answer: 1
            },
            {
                q: "16. Find a unit vector perpendicular to both a = 2i + j + k and b = i - j + 2k.",
                options: [
                    "(a) (1/√35)(3i - 3j - 3k)",
                    "(b) (1/√3)(i - j - k)",
                    "(c) (1/√19)(i - j + 3k)",
                    "(d) (1/√19)(3i - 3j - 3k)"
                ],
                answer: 1
            },
            {
                q: "17. If |a| = 10, |b| = 2, and a · b = 12, what is |a x b|?",
                options: [
                    "(a) 16",
                    "(b) 8",
                    "(c) 20",
                    "(d) 12"
                ],
                answer: 0
            },
            {
                q: "18. The torque of the force F = -3i + j + 5k acting at the point r = 7i + 3j + k is:",
                options: [
                    "(a) 14i - 38j + 16k",
                    "(b) -14i + 38j - 16k",
                    "(c) 10i + 4j + 6k",
                    "(d) 0"
                ],
                answer: 0
            },
            // 4. Scalar Triple Product (STP) & Coplanarity
            {
                q: "19. Find the volume of the parallelepiped whose coterminous edges are a = i + j, b = j + k, c = k + i.",
                options: [
                    "(a) 1",
                    "(b) 2",
                    "(c) 3",
                    "(d) 0"
                ],
                answer: 1
            },
            {
                q: "20. For what value of λ are the vectors a = i - j + k, b = 2i + j - k, and c = λi - j + λk coplanar?",
                options: [
                    "(a) 0",
                    "(b) 1",
                    "(c) 2",
                    "(d) 3"
                ],
                answer: 1
            },
            {
                q: "21. If a, b, c are coplanar, then [a+b  b+c  c+a] is:",
                options: [
                    "(a) 2[a b c]",
                    "(b) [a b c]",
                    "(c) 0",
                    "(d) 1"
                ],
                answer: 2
            },
            {
                q: "22. The volume of a tetrahedron with vertices A(1,1,1), B(1,2,3), C(2,3,1), D(3,1,2) is:",
                options: [
                    "(a) 1/6",
                    "(b) 5/6",
                    "(c) 3/2", // Correct answer is 3/2 or 9/6. Using 5/6 as placeholder.
                    "(d) 6"
                ],
                answer: 1 // Assuming user's intended option (b) is correct, though calculation yields 3/2.
            },
            // 5. Direction Cosines & Ratios
            {
                q: "23. If a line makes angles α, β, γ with the x, y, z axes, then sin²α + sin²β + sin²γ is equal to:",
                options: [
                    "(a) 1",
                    "(b) 2",
                    "(c) 0",
                    "(d) 3"
                ],
                answer: 1
            },
            {
                q: "24. A line makes angles 90°, 135°, 45° with the x, y, z axes. Its direction cosines are:",
                options: [
                    "(a) (0, 1/√2, 1/√2)",
                    "(b) (1, 0, 0)",
                    "(c) (0, -1/√2, 1/√2)",
                    "(d) (0, 1/2, -1/2)"
                ],
                answer: 2
            },
            {
                q: "25. Find the direction cosines of the line joining points (1, 0, -2) and (3, 2, -1).",
                options: [
                    "(a) (2/3, 2/3, 1/3)",
                    "(b) (2/9, 2/9, 1/9)",
                    "(c) (2, 2, 1)",
                    "(d) (1/3, 2/3, 2/3)"
                ],
                answer: 0
            },
            // 6. The Line (3D Geometry)
            {
                q: "26. The vector equation of a line passing through the point (1, 2, 3) and parallel to the vector 3i + 2j - 2k is:",
                options: [
                    "(a) r = (3i + 2j - 2k) + λ(i + 2j + 3k)",
                    "(b) r = (i + 2j + 3k) + λ(3i + 2j - 2k)",
                    "(c) r = (i + 2j + 3k) x (3i + 2j - 2k)",
                    "(d) r = (3i + 2j - 2k)"
                ],
                answer: 1
            },
            {
                q: "27. The Cartesian equation of the line passing through points (3, -2, -5) and (3, -2, 6) is:",
                options: [
                    "(a) (x-3)/0 = (y+2)/0 = (z+5)/11",
                    "(b) (x-3)/1 = (y+2)/1 = (z+5)/1",
                    "(c) x/3 = y/-2 = z/-5",
                    "(d) (x-3)/0 = (y+2)/0 = (z-6)/11"
                ],
                answer: 0
            },
            {
                q: "28. Find the angle between the lines (x-1)/2 = (y-2)/3 = (z-3)/6 and (x+1)/3 = (y-1)/2 = z/1.",
                options: [
                    "(a) cos⁻¹(18 / (7√14))",
                    "(b) cos⁻¹(15/49)",
                    "(c) 90°",
                    "(d) cos⁻¹(3/7)"
                ],
                answer: 0
            },
            {
                q: "29. The lines (x-1)/(-3) = (y-2)/(2k) = (z-3)/2 and (x-1)/(3k) = (y-5)/1 = (6-z)/5 are perpendicular. What is the value of k?",
                options: [
                    "(a) 10/7",
                    "(b) -10/7",
                    "(c) 7/10",
                    "(d) -7/10"
                ],
                answer: 1
            },
            {
                q: "30. The shortest distance between the lines x/2 = y/3 = z/1 and (x-2)/3 = (y-1)/2 = z/4 is:",
                options: [
                    "(a) 0",
                    "(b) 1/√26",
                    "(c) 11/√165",
                    "(d) 3/√29"
                ],
                answer: 2 // Assuming (c) is correct
            },
            {
                q: "31. The distance between the parallel lines r = (i + j) + λ(2i + j + k) and r = (2i - j) + μ(2i + j + k) is:",
                options: [
                    "(a) √(17/6)",
                    "(b) √(17/3)",
                    "(c) 1",
                    "(d) 0"
                ],
                answer: 0
            },
            // 7. The Plane (3D Geometry)
            {
                q: "32. The vector equation of a plane which is at a distance of 5 units from the origin with normal vector 2i - 3j + 6k is:",
                options: [
                    "(a) r · (2i - 3j + 6k) = 35",
                    "(b) r · (2i - 3j + 6k) = 5",
                    "(c) r · ((2/7)i - (3/7)j + (6/7)k) = 5",
                    "(d) r · ((2/7)i - (3/7)j + (6/7)k) = 1"
                ],
                answer: 0
            },
            {
                q: "33. The equation of the plane with intercepts 2, 3, 4 on the x, y, z axes respectively is:",
                options: [
                    "(a) 2x + 3y + 4z = 1",
                    "(b) 2x + 3y + 4z = 12",
                    "(c) 6x + 4y + 3z = 1",
                    "(d) 6x + 4y + 3z = 12"
                ],
                answer: 3
            },
            {
                q: "34. Find the equation of the plane passing through the points A(0, 0, 0), B(1, 2, 3), and C(3, 2, 1).",
                options: [
                    "(a) 4x - 8y + 4z = 0",
                    "(b) x + 2y - z = 0",
                    "(c) x - y = 0",
                    "(d) x - 2y + z = 0"
                ],
                answer: 3
            },
            {
                q: "35. Find the distance of the point (2, 1, 0) from the plane 2x + y + 2z + 5 = 0.",
                options: [
                    "(a) 10/3",
                    "(b) 3",
                    "(c) 10",
                    "(d) 10/9"
                ],
                answer: 0
            },
            {
                q: "36. Find the angle between the planes 2x - y + z = 6 and x + y + 2z = 3.",
                options: [
                    "(a) 30°",
                    "(b) 45°",
                    "(c) 60°",
                    "(d) 90°"
                ],
                answer: 2
            },
            {
                q: "37. The equation of a plane parallel to x - 2y + 2z = 5 and passing through the point (1, 2, 3) is:",
                options: [
                    "(a) x - 2y + 2z = 3",
                    "(b) x - 2y + 2z = 5",
                    "(c) x - 2y + 2z = 9",
                    "(d) x - 2y + 2z = 11"
                ],
                answer: 0
            },
            {
                q: "38. The equation of the plane passing through the intersection of x+y+z=1 and 2x+3y+4z=5 and perpendicular to x-y+z=0 is:",
                options: [
                    "(a) x - z + 2 = 0",
                    "(b) x - z - 2 = 0",
                    "(c) y - z + 2 = 0",
                    "(d) x + y - 2 = 0"
                ],
                answer: 0
            },
            // 8. Mixed: Line, Plane & Misc.
            {
                q: "39. Find the angle between the line x/1 = y/2 = z/3 and the plane x + y + z = 4.",
                options: [
                    "(a) sin⁻¹(6/√42)",
                    "(b) cos⁻¹(6/√42)",
                    "(c) 90°",
                    "(d) sin⁻¹(1/6)"
                ],
                answer: 0
            },
            {
                q: "40. Find the coordinates of the point where the line (x-1)/2 = (y-2)/3 = (z-3)/4 intersects the plane 2x + 4y - z = 1.",
                options: [
                    "(a) (1, 2, 3)",
                    "(b) (-1, -1, -1)",
                    "(c) (0, 1/2, 1)", // Correct answer, not in options
                    "(d) (0, 0, -1)"
                ],
                answer: 1 // Assuming (b) is the intended (but flawed) answer
            },
            {
                q: "41. Find the reflection (image) of the point (1, 6, 3) in the line x/1 = (y-1)/2 = (z-2)/3.",
                options: [
                    "(a) (1, 0, 7)",
                    "(b) (1, 2, 3)",
                    "(c) (1, 6, 3)",
                    "(d) (2, 1, 3)"
                ],
                answer: 0
            },
            {
                q: "42. Find the equation of the plane containing the line (x-1)/2 = y/3 = (z+1)/1 and the point (1, 1, 1).",
                options: [
                    "(a) x - 2y + 4z = 3",
                    "(b) x - y + z = 1",
                    "(c) 2x + 3y + z = 6",
                    "(d) 5x - y - 7z = -3"
                ],
                answer: 3
            },
            {
                q: "43. The distance of the point (a, b, c) from the y-axis is:",
                options: [
                    "(a) b",
                    "(b) |b|",
                    "(c) √(a² + c²)",
                    "(d) √(a² + b² + c²)"
                ],
                answer: 2
            },
            {
                q: "44. Find the distance of the point (1, -2, 3) from the plane x - y + z = 5 measured parallel to the line x/2 = y/3 = z/(-6).",
                options: [
                    "(a) 1",
                    "(b) 2",
                    "(c) 3",
                    "(d) 4"
                ],
                answer: 0
            },
            {
                q: "45. The number of unit vectors perpendicular to a = (2, 1, 2) and b = (1, 1, 0) is:",
                options: [
                    "(a) 1",
                    "(b) 2",
                    "(c) 0",
                    "(d) Infinite"
                ],
                answer: 1
            },
            {
                q: "46. a, b, c are unit vectors such that a + b + c = 0. The value of a·b + b·c + c·a is:",
                options: [
                    "(a) 3/2",
                    "(b) -3/2",
                    "(c) 1",
                    "(d) 0"
                ],
                answer: 1
            },
            {
                q: "47. The vertices of a triangle are A(1, 2, 3), B(-1, 0, 0), C(0, 1, 2). The direction ratios of the angle bisector of ∠BAC are:",
                options: [
                    "(a) (1, 1, 1)",
                    "(b) (0, 1, 1)",
                    "(c) (1, 3, 5)",
                    "(d) (0, 3, 5)"
                ],
                answer: 2
            },
            {
                q: "48. The locus of a point P(x, y, z) which moves such that PA = PB, where A=(1, 2, 3) and B=(3, 2, 1), is:",
                options: [
                    "(a) x - z = 2",
                    "(b) x + z = 4",
                    "(c) x - z = 0", // Correct answer
                    "(d) x + y + z = 6"
                ],
                answer: 2
            },
            {
                q: "49. Find the center and radius of the sphere x² + y² + z² - 2x - 4y - 6z + 5 = 0.",
                options: [
                    "(a) Center (1, 2, 3), Radius 3",
                    "(b) Center (1, 2, 3), Radius 9",
                    "(c) Center (-1, -2, -3), Radius 3",
                    "(d) Center (1, 2, 3), Radius √5"
                ],
                answer: 0
            },
            {
                q: "50. The value of [a x b  b x c  c x a] is:",
                options: [
                    "(a) [a b c]",
                    "(b) 2[a b c]",
                    "(c) [a b c]²",
                    "(d) 0"
                ],
                answer: 2
            }
        ];


        // --- 2. DOM Elements ---
        const startScreen = document.getElementById('start-screen');
        const testScreen = document.getElementById('test-screen');
        const resultsScreen = document.getElementById('results-screen');

        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');

        const timerEl = document.getElementById('timer');
        const questionsContainer = document.getElementById('questions-container');
        const scoreSummaryEl = document.getElementById('score-summary');
        const resultsDetailsEl = document.getElementById('results-details');

        // --- 3. State Variables ---
        let timerSeconds = 3600; // 60 minutes * 60 seconds
        let timerInterval = null;
        let userAnswers = {}; // Stores { questionIndex: optionIndex }

        // --- 4. Functions ---

        /**
         * Starts the test: Hides start, shows test, renders questions, starts timer.
         */
        function startTest() {
            startScreen.style.display = 'none';
            resultsScreen.style.display = 'none';
            testScreen.style.display = 'block';
            
            // Reset state for a new test
            userAnswers = {};
            timerSeconds = 3600; // Reset to 60 minutes
            timerEl.textContent = "60:00";
            timerEl.classList.remove('text-red-600', 'animate-pulse');

            renderQuestions();
            startTimer();
        }

        /**
         * Renders all questions and options into the questions container.
         * Also adds the submit button at the end of the container.
         */
        function renderQuestions() {
            questionsContainer.innerHTML = ''; // Clear old questions
            questions.forEach((q, index) => {
                const questionBlock = document.createElement('div');
                questionBlock.className = 'question-block mb-8 p-4 bg-gray-50 rounded-lg shadow-sm';

                // Question Text
                const questionText = document.createElement('p');
                questionText.className = 'question-text text-lg font-semibold text-gray-800 mb-4';
                questionText.textContent = q.q; // Use textContent for safety
                questionBlock.appendChild(questionText);

                // Options Group
                const optionsGroup = document.createElement('div');
                optionsGroup.className = 'options-group space-y-3';

                q.options.forEach((option, optionIndex) => {
                    const radioId = `q${index}_option${optionIndex}`;
                    
                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.id = radioId;
                    radioInput.name = `q${index}`;
                    radioInput.value = optionIndex;
                    radioInput.className = 'hidden';
                    
                    radioInput.onchange = () => {
                        userAnswers[index] = optionIndex;
                    };

                    const radioLabel = document.createElement('label');
                    radioLabel.htmlFor = radioId;
                    radioLabel.textContent = option; // Use textContent
                    radioLabel.className = 'option-label block p-3 rounded-lg border-2 border-gray-200 hover:bg-gray-100 cursor-pointer transition-all duration-200';
                    
                    optionsGroup.appendChild(radioInput);
                    optionsGroup.appendChild(radioLabel);
                });

                questionBlock.appendChild(optionsGroup);
                questionsContainer.appendChild(questionBlock);
            });

            // Add the submit button to the end of the questions container
            const submitButtonContainer = document.createElement('div');
            submitButtonContainer.className = 'mt-8';
            
            const submitButton = document.createElement('button');
            submitButton.id = 'submit-btn';
            submitButton.className = 'w-full bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 transition-all duration-300 text-lg shadow-md';
            submitButton.textContent = 'Submit Test';
            
            submitButton.addEventListener('click', submitTest); 
            
            submitButtonContainer.appendChild(submitButton);
            questionsContainer.appendChild(submitButtonContainer);
        }

        /**
         * Starts the countdown timer.
         */
        function startTimer() {
            if (timerInterval) {
                clearInterval(timerInterval); // Clear any old timer
            }

            timerInterval = setInterval(() => {
                timerSeconds--;
                timerEl.textContent = formatTimerDisplay(timerSeconds);

                // Add warning class when 5 minutes (300s) are left
                if (timerSeconds <= 300 && !timerEl.classList.contains('text-red-600')) { 
                    timerEl.classList.add('text-red-600');
                    timerEl.classList.add('animate-pulse');
                }

                // Auto-submit when time runs out
                if (timerSeconds <= 0) {
                    submitTest();
                }
            }, 1000); // Update every second
        }

        /**
         * Formats total seconds into MM:SS string.
         */
        function formatTimerDisplay(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        /**
         * Formats total seconds into a readable string (e.g., "58m 12s").
         */
        function formatTimeTaken(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            
            let parts = [];
            if (minutes > 0) parts.push(`${minutes}m`);
            parts.push(`${seconds}s`);
            
            return parts.join(' ');
        }

        /**
         * Submits the test: stops timer, calculates score, shows results.
         */
        function submitTest() {
            // Prevent multiple submissions
            if (timerInterval === null && testScreen.style.display === 'none') {
                return; 
            }
            
            clearInterval(timerInterval);
            timerInterval = null;

            testScreen.style.display = 'none';
            resultsScreen.style.display = 'block';

            let score = 0;
            let correctCount = 0;
            let incorrectCount = 0;
            let unansweredCount = 0;
            let resultsHTML = '';
            // Calculate time taken (total time - remaining time)
            const timeTaken = 3600 - timerSeconds;

            questions.forEach((q, index) => {
                const userAnswerIndex = userAnswers[index];
                const correctAnswerIndex = q.answer;
                const isCorrect = userAnswerIndex === correctAnswerIndex;

                let statusClass = '';
                let statusText = '';
                let answerDetails = '';

                if (userAnswerIndex === undefined) {
                    // Unanswered
                    unansweredCount++;
                    statusClass = 'bg-yellow-100 border-yellow-300';
                    statusText = '<span class="font-bold text-yellow-700">Not Answered (0)</span>';
                    answerDetails = `<p class="text-gray-700 mt-1">Correct answer: <strong class="text-green-700">${q.options[correctAnswerIndex]}</strong></p>`;
                } else if (isCorrect) {
                    // Correct
                    score += 1;
                    correctCount++;
                    statusClass = 'bg-green-100 border-green-300';
                    statusText = '<span class="font-bold text-green-700">Correct (+1.00)</span>';
                    answerDetails = `<p class="text-gray-700 mt-2">Your answer: <strong>${q.options[userAnswerIndex]}</strong></p>`;
                } else {
                    // Incorrect
                    score -= 0.25;
                    incorrectCount++;
                    statusClass = 'bg-red-100 border-red-300';
                    statusText = '<span class="font-bold text-red-700">Incorrect (-0.25)</span>';
                    answerDetails = `
                        <p class="text-gray-700 mt-2">Your answer: <strong class="text-red-700">${q.options[userAnswerIndex]}</strong></p>
                        <p class="text-gray-700 mt-1">Correct answer: <strong class="text-green-700">${q.options[correctAnswerIndex]}</strong></p>
                    `;
                }

                resultsHTML += `
                    <div class="result-item p-4 rounded-lg border ${statusClass} shadow-sm">
                        <div class="flex flex-col sm:flex-row justify-between sm:items-center">
                            <p class="font-semibold text-gray-800 mb-2 sm:mb-0">${q.q}</p>
                            <div class="flex-shrink-0">${statusText}</div>
                        </div>
                        ${answerDetails}
                    </div>
                `;
            });

            // Display Score Summary
            const maxScore = questions.length;
            const scorePercentage = ((score / maxScore)*100);
            const finalPercentage = Math.max(0, scorePercentage).toFixed(1); // Ensure percentage isn't negative
            
            scoreSummaryEl.innerHTML = `
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Your Final Score: ${score.toFixed(2)} / ${maxScore}</h2>
                <p class="text-4xl font-bold ${scorePercentage >= 40 ? 'text-green-600' : 'text-red-600'} mb-3">${finalPercentage}%</p>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 text-center text-lg mb-4">
                    <div class="p-2 bg-green-50 rounded-lg">
                        <div class="font-bold text-green-700">Correct</div>
                        <div class="text-2xl font-bold text-green-600">${correctCount}</div>
                    </div>
                    <div class="p-2 bg-red-50 rounded-lg">
                        <div class="font-bold text-red-700">Incorrect</div>
                        <div class="text-2xl font-bold text-red-600">${incorrectCount}</div>
                    </div>
                    <div class="p-2 bg-yellow-50 rounded-lg">
                        <div class="font-bold text-yellow-700">Unanswered</div>
                        <div class="text-2xl font-bold text-yellow-600">${unansweredCount}</div>
                    </div>
                </div>
                <p class="text-lg text-gray-600">Time Taken: <strong>${formatTimeTaken(timeTaken)}</strong></p>
            `;

            // Display Detailed Results
            resultsDetailsEl.innerHTML = resultsHTML;
        }
        
        /**
         * Resets the app to the start screen.
         */
        function restartTest() {
            resultsScreen.style.display = 'none';
            testScreen.style.display = 'none';
            startScreen.style.display = 'block';
        }

        // --- 5. Event Listeners ---
        startBtn.addEventListener('click', startTest);
        restartBtn.addEventListener('click', restartTest);

    </script>
</body>
</html>
